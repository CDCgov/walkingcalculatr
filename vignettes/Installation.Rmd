---
title: "Installation"
date: '`r paste("First created on April 01, 2023. Updated on ", Sys.Date())`'
output:
  html_document: 
    df_print: kable
---

***
The `walkingcalculatr` package has been developed and tested using R version 3.6.
To install the latest development version from GitHub, use `remotes`, an R package installer alternative (more about `remotes` [here](https://github.com/r-lib/remotes)). Usage of `remotes` rather than `devtools` circumvents possible installation issues related to `devtools` dependencies in Windows.

**NOTE:** While `walkingcalculatr` remains an internal CDCENT product, access to CDCENT and a valid personal access token (PAT) is required in order to install, which can be done using the following steps:

1. Use this [link](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#personal-access-tokens-classic) to generate a **Personal access tokens (classic)**
2. Make a copy of the PAT you have generated
3. Enable SSO with CDCENT
4. Run `gitcreds::gitcreds_set()` and enter your PAT (without quotations)

Install the `walkingcalculatr` package from the CDCENT GitHub using `remotes` in the R console with the below.
```{r, eval = FALSE}
remotes::install_github("https://github.com/cdcent/walkingcalculatr")
```

If a PAT is needed, then add your PAT into `auth_token`.
```{r, eval = FALSE}
remotes::install_github("https://github.com/cdcent/walkingcalculatr", 
                        auth_token = 'insert_PAT_here')
```

`walkingcalculatr` itself has several dependencies, so it may take a little while to download and install everything on your machine. 

If data partitioning is required due to memory limitations, steps on data manipulation and partitioning using Spark can be found in [Spark_Overview](Spark_Overview.Rmd). Currently `walkingcalculatr` functions have been tested for partitions < 200 million rows using a 64 GB Linux machine.

## Platform-specific installation for dependencies

While usage of `remotes::install_github()` should prevent any issues with installation, there may be some dependencies that R will not be able to install through CRAN that were discovered when using `devtools::install_github()`. If the need arises, the following commands can be run on a given operating system's command line interface to install these dependencies. Through user tests, we have identified the following dependencies that may not be automatically installed when installing `walkingcalculatr`.

- Windows: `usethis`, `libcurl`, `libfontconfig1-dev`, `libxml2-dev`, `libudunits2-dev`, `libgdal-dev`, `libproj-dev` 
- MacOS: `libgit2`, `proj`, `udunits`, `geos`, `fribidi`, `librttopo`

### macOS

A working version of `homebrew` can be used to install dependencies. [Homebrew](https://brew.sh/) can be installed by navigating to the terminal and running the following command:

```
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

Once installed, `homebrew` can install each of the required dependencies:
```
brew install <package-name>
```

### Windows

On Windows, dependencies can be installed by navigating to the command prompt and running the following:
```
sudo apt-get install <package-name>
```

## Optional packages

These packages are not required for running the main functions of `walkingcalculatr`, but may be necessary for certain use cases.
```{r, eval = FALSE}
install.packages(c("ggplot2", "ggrepel","gtools"))
```

## Alternate GitHub installation using `pak`
Another way to install the latest development version from GitHub is to use `pak`, an R package installer alternative (more about `pak` [here](https://pak.r-lib.org/)). Usage of `pak` rather than `devtools` circumvents possible installation issues related to `devtools` dependencies in Windows.

After following the above, `walkingcalculatr` can be installed using `pak::pkg_install()`.
```{r, eval = FALSE}
install.packages("pak")
pak::pkg_install("cdcent/walkingcalculatr")
```

Using `pak` will install `walkingcalculatr` and install several additional packages in turn.

## Source-level install for developers

If you are editing the `walkingcalculatr` code itself, you can clone or fork the `walkingcalculatr` source code and then install it from source. To clone the source using git:

```
git clone https://github.com/cdcent/walkingcalculatr.git
```

again, ensuring that you have access to CDCENT before you do.

Once you have the `walkingcalculatr` package source, open an R session from the `walkingcalculatr` base directory. Then install `walkingcalculatr` using the R `remotes` package pointed to the directory where `walkingcalculatr` was cloned.

```{r, eval = FALSE, warning = FALSE}
remotes::install_local("path/to/cloned/walkingcalculatr")
```

## Local installation

To download a local version of the package, download a tarball or compressed file (tar, zip, tar.gz tar.bz2, tgz2 or tbz) of the package [here](https://github.com/cdcent/walkingcalculatr/archive/refs/heads/main.zip), then use `remotes::install_local()`.
```{r,  eval = FALSE}
remotes::install_local("path/to/package")
```
